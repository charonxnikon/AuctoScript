# MODELING-STOCHASTIC-MARKETS

Глобально есть 3 проекта: 

1. Серверная часть на Си
2. Интерпретатор на С++
3. Интерактивная часть на Python

# Сервер на Си
Стартовыми параметрами сервера являются число пользователей и номер TSP-порта и иногда файл типа .txt, содержащий данные DATE,TIME,OPEN,HIGH,LOW,CLOSE,VOL
без заголовков. Стартовые параметры задаются в командной строке программы-сервера.

После запуска программы, она должна открыть сокет в режиме ожидания запросов на соединение на заданном порту, дождаться подключения заданного количества пользователей, после чего запустить моделирование. Моделирование происходит до тех пор, пока все пользователи, кроме одного, по тем или иным причинам не покинут моделирование или пока в заданном файле не закончатся строки, интерпретируемые как биржевые лаги.

После запуска программы-сервера она должна открыть сокет в режиме ожидания запросов на соединение на заданном порту, дождаться подключения заданного количества пользователей, после чего перейти в режим моделирования, в котором и оставаться до момента, когда все пользователи, кроме одного, но тем или иным причинам не выйдут из моделирования.

Сервер не должен использовать активное ожидание и бязан корректно обрабатывать потерю соединения с любым из пользователей. 

Команды на сервере: 

<img width="791" alt="Снимок экрана 2023-12-21 в 03 36 37" src="https://github.com/charonxnikon/MODELING_STOCHASTIC_MARKETS/assets/73964925/12ec25ae-e468-427a-bbcf-44a631e2f651">


количество пользователей (макс), IP(0, если localhost), запуск только с 3 параметрами

Следует учитывать при запуске, что в большинстве операционных систем порты с номерами от 1 до 1023 считаются привилегированными. Тогда использовать их могут только процессы, обладающие правами суперпользователя.

Для протоколирования покупок и продаж, производимых на сервере, необходимо из структуры пользователей записывать на каждом шаге номер участника, баланс, количество единиц продукта, количество проданных единиц продукта, количество купленных единиц продукта, цена закрытия на рынке и количество единиц продукта на рынке.
Для этого создается файле prot.txt, в котором данные имеют следующий вид:

<img width="686" alt="Снимок экрана 2023-12-21 в 03 13 18" src="https://github.com/charonxnikon/MODELING_STOCHASTIC_MARKETS/assets/73964925/a39484ed-2578-4c5c-a797-1d83e845b6f5">


Реализован подход без использования конкретных файлов из finam, модель взята из статьи 2023 года, журнал Financial Statistical Journal:  

Model of stochastic auctions using level market index
Nikonov Maksim, Shishkin Alexei, Konev Dmitry, Dolmatov Aleksandr
https://systems.enpress-publisher.com/index.php/FSJ/article/view/2931

Запуск: gcc ... 

Пример: 
```bash
gcc −Wall −g server_2 . c −o server_1 testing . txt 
./ server_1 2000 2
```
(Подключение двух пользователей к 2000 порту)
```bash
gcc −Wall −g server_vfinal_2 . c −o server_2 
./ server_2 3000 4
```
в случе без реальных данных

Подключение производится с помощью утилиты telnet.

# Интерпретатор на С++

Стартовыми параметрами программмы-интерпретатора являются ip-адрес и номер TSP-порта сервера, а также имя файла, содержащего программу на модельном языке. Сценарий определяет дальнейшее поведение бота. Таким образом программа-бот представляет собой комбинацию программы-клиента и программы-интерпретатора модельного языка.

Программа принимает на вход файл с программой на языке программирования AuctoScript, язык является алгоритмически полным.
В языке присутствуют следующие операторы: присваивания, безусловного перехода, условный оператор, оператор аукционных действий, оператор отладочной печати
Результатом работы анализатора должно стать внутреннее представление сценария, удобное для дальнейшей интерпретации ПОЛИЗ.

Не работает отдельно от сервера: программа-интерпретатор - это скрипт поведения пользователя на сервере, порт должен быть одинаковый 

<img width="691" alt="Снимок экрана 2023-12-21 в 03 12 10" src="https://github.com/charonxnikon/MODELING_STOCHASTIC_MARKETS/assets/73964925/08a046c3-d7e8-446b-acf8-f0f2eca8a81c">

Примеры программ находятся в директории: intelligente и ahmoq 

Запуск: g++ ... 

Пример:
```bash
g++ −Wall −g interpreter .cpp −o inter
./ inter 0 2000 stupido
```

Пример программы на интерпретируемом языке AuctoScript: 
```c
{
	
	$failsprodprice = 0;
	$users = ?active_players();
	$count_fac = ?factories(?my_id());
	
	while ?money(?my_id()) < $demand * 2000{
        	$count_fac = $count_fac - 1;
 	};
	?prod($count_fac);
		if ?result_raw_sold($k) < 1{
			$failsrawcount[$i3] = ?result_raw_sold($k);
			$failsrawprice[$i4] = ?result_raw_price($k);
			$i3 = $i3 + 1;
			$i4 = $i4 + 1;
		};
	if $deltaraw <= 3{
		?buy(2,?raw_price());
	};	 
}
end
```
# Интерактивная часть на Python

Для интерактивной части использовался tkinter, необходимо запустить .ipynb файл (использует выход серверной части) и все файлы формата .py 

Запуск: 
```bash
python3 <filename.py>
```
Для ipynb файла необходимо имет среду IDE. 


<img width="613" alt="Снимок экрана 2023-12-21 в 03 41 53" src="https://github.com/charonxnikon/MODELING_STOCHASTIC_MARKETS/assets/73964925/2f7d7ccf-0a4d-44ac-9f3c-4f0d208a5335">





 
 
